% MAPE
clc 
clear all 
close all 

n = 4;
c = 12;
T0 = 85;
B0 = 11474;
Yt = [10289.5 11717 18623 15057 7718 8762 7384 9378 10996.5 16339 16686 10366 11421 12436 18593 16771 7915 8690 8432 10108 11812 18431 18477 11107 13409 13284 18942 18601 8941 9396 9594 11232 12093 20635 18820 12933];
St = [0.90 1.01 1.60 1.28 0.65 0.74 0.62 0.78 0.90 1.33 1.35 0.84 0.92 1.00 1.48 1.33 0.62 0.68 0.65 0.78 0.90 1.40 1.40 0.83 0.99 0.98 1.38 1.35 0.65 0.67 0.68 0.80 0.85 1.44 1.31 0.89];
Bt = [11491.57175 11548.65953 11636.13921 11728.32521 11816.14276 11901.10271 11985.75727 12070.88126 12156.27024 12241.67403 12327.02851 12412.35878 12685.45258 12412.84805 11734.78821 12644.0414 12414.95713 11885.39953 13197.93461 13321.73717 13141.7271 13631.78774 13747.79958 13418.88199 14232.488 13676.46065 12859.33745 13601.2005 14361.4336 14114.77028 14502.70662 14517.91755 13617.80213 14301.72816 13792.16328 15043.44348];
Tt = [18.24603257 56.69936232 87.17187529 92.13586433 87.86072753 84.98895879 84.65790767 85.11932233 85.3862824 85.40361754 85.35497363 85.33051852 271.2161654 -267.166323 -673.9509058 893.4211497 -217.8592189 -526.4406134 1294.145321 135.5059935 -176.8549083 483.3914792 119.6856381 -324.4315539 802.2256278 -542.4448182 -814.3764183 726.3006576 759.8937757 -236.5977465 381.6909951 18.87573053 -890.9255119 668.1775211 -497.7874568 1233.789525];

gamma = 0.9;
t0 = 25 ;

MAPE1=0;
MAPE2=0;
MAPE3=0;
MAPE4=0;
MAPEf=[];

for i=0:0.01:1
    for j=0:0.01:1
        alpha=i;
        beta=j;
        
        %Horizon1
        t1=t0-n+1;
        t1n=t0-n+1+(c-1);
        for k=t1:1:t1n
            for h=1:1:12
            B1=alpha*(Yt(k)/St(k-c)) + (1-alpha)*(Bt(k-1)+Tt(k-1));
            T1=beta*(B1-Bt(k-1)) + (1-beta)*Tt(k-1);
            F(h)=(B1+h*T1)*St(k+h-c);
            end
        end
        for h=1:1:12
            MAPEt=(1/12)*abs(Yt(t1+h)-F(h))/(Yt(t1+h));
            MAPE1=MAPEt + MAPE1;
        end
        
        %Horizon2
        t2=t0-n+2;
        t2n=t0-n+2+(c-1);
        for k=t2:1:t2n
            for h=1:1:12
            B1=alpha*(Yt(k)/St(k-c)) + (1-alpha)*(Bt(k-1)+Tt(k-1));
            T1=beta*(B1-Bt(k-1)) + (1-beta)*Tt(k-1);
            F(h)=(B1+h*T1)*St(k+h-c);
            end
        end
        for h=1:1:12
            MAPEt=(1/12)*abs(Yt(t2+h)-F(h))/(Yt(t2+h));
            MAPE2=MAPEt + MAPE2;
        end
        
        %Horizon3
        t3=t0-n+3;
        t3n=t0-n+3+(c-1);
        for k=t3:1:t3n
            for h=1:1:12
            B1=alpha*(Yt(k)/St(k-c)) + (1-alpha)*(Bt(k-1)+Tt(k-1));
            T1=beta*(B1-Bt(k-1)) + (1-beta)*Tt(k-1);
            F(h)=(B1+h*T1)*St(k+h-c);
            end
        end
        for h=1:1:12
            MAPEt=(1/12)*abs(Yt(t3+h)-F(h))/(Yt(t3+h));
            MAPE3=MAPEt + MAPE3;
        end
        
        %Horizon4
        t4=t0-n+4;
        t4n=t0-n+4+(c-1);
        for k=t4:1:t4n
            for h=1:1:12
            B1=alpha*(Yt(k)/St(k-c)) + (1-alpha)*(Bt(k-1)+Tt(k-1));
            T1=beta*(B1-Bt(k-1)) + (1-beta)*Tt(k-1);
            F(h)=(B1+h*T1)*St(k+h-c);
            end
        end
        for h=1:1:11
            MAPEt=(1/12)*abs(Yt(t4+h)-F(h))/(Yt(t4+h));
            MAPE4=MAPEt + MAPE4;
        end
        
        
        MAPEf = [MAPEf,(MAPE1+MAPE2+MAPE3+MAPE4)/4];
        
        
        
    end
end
